<!DOCTYPE html>
<!--
    VGG Image Annotator (via)

    Copyright (C) 2016, Abhishek Dutta <adutta@robots.ox.ac.uk>
    Aug. 31, 2016
  -->

<html lang="en">
  <head>
    <meta charset="UTF-8"> 
    <title>VGG Image Annotator</title>
    <meta name="author" content="Abhishek Dutta">
    <meta name="description" content="VGG Image Annotator (via) is a light-weight image annotation tool built solely using HTML, CSS and pure Javascript (not using any javascript libraries).">

    <!-- CSS style definition -->
    <style type="text/css">     
      body {
      min-width: 800px;
      padding: 0;
      margin: 0;
      margin-bottom: 3em;
      }
      
      #wrapper {
      display: table;
      text-align: center;
      }

      #navbar {
      position: relative;
      top: 0;
      left: 0;
      font-family: Sans;
      display: table;
      height: 1px;
      background: #000000;
      width: 100%;
      z-index: 1000;
      }
      
      #navbar ul {
      font-size: medium;
      list-style-type: none;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #333;
      }

      #navbar li {
      float: left;
      }

      #navbar li a, .drop_menu_item {
      display: inline-block;
      color: white;
      text-align: center;
      padding: 1em 1.2em;
      text-decoration: none;
      }

      #navbar li a:hover, .dropdown:hover .drop_menu_item {
      background-color: #999999;
      cursor: pointer;
      }

      #navbar li.dropdown {
      display: inline-block;
      }

      #navbar .dropdown-content {
      display: none;
      position: absolute;
      background-color: #333333;
      min-width: 160px;
      border: 1px solid #ffffff;
      }

      #navbar .dropdown-content a {
      color: #ffffff;
      padding: 0.4em 0.6em;
      text-decoration: none;
      font-size: small;
      display: block;
      text-align: left;
      background-color: #333333;
      float: none;
      }

      #navbar .dropdown-content a:hover {
      background-color: #000000;
      color: #ffff00;
      }

      #navbar .dropdown:hover .dropdown-content {
      display: block;
      }

      .main {
      display: table;
      width: 100%;
      }

      .box {
      display: table-cell;
      padding: 1em 0;
      vertical-align: top;
      }

      .box canvas {
      position: relative;
      }

      /* Panel in the left hand side of image canvas */
      .sidebar {
      font-family: Mono;
      font-size: small;
      /*width: 250px;*/
      padding: 1em 1em;
      vertical-align: top;
      }
      .sidebar .title {
      font-family: Sans;
      font-size: large;
      padding-top: 1em;
      padding-bottom: 0.5em;
      }
      .sidebar .info table {
      border-collapse: collapse;
      table-layout: fixed;
      min-width: 250px;
      max-width: 400px;
      }
      .sidebar .info table, td {
      border: 1px solid #cccccc;
      padding: 0 0.4em;
      line-height: 2em;
      overflow: hidden;
      text-overflow: ellipsis;
      }

      /* Toolbar to select region shape */
      .region_shape {
      display: inline-block;
      stroke: #333333;
      fill: #cccccc;
      background-color: #ffffff;
      padding: 0 0.5em;
      }
      .region_shape:hover {
      fill: #ff0000;
      cursor: pointer;
      }
      .region_shape_selected {
      background-color: #e5e5e5;
      }
      .region_shape_selected:hover {
      fill: #cccccc;
      }
      
      
      #message_panel {
      position: fixed;
      left: 0;
      bottom: 0px;
      line-height: 3em;
      width: 100%;
      background-color: #333333;
      color: #ffff00;
      font-size: small;
      font-family: Mono;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      }
      
      #annotation_textarea {
      display: none;
      }

      #invisible_file_input {
      width: 0.1px;
      height: 0.1px;
      opacity: 0;
      overflow: hidden;
      position: absolute;
      z-index: -1;
      }
      #image_panel {
      display: inline-block;
      margin: auto;
      }
      #about_panel {
      display: inline-block;
      margin: auto;
      width: 80%;
      font-family: Sans;
      font-size: default;
      line-height: 1.5em;
      margin: 0;
      }
      #about_panel li {
      margin: 1em 0;
      }
      
      .editable_table tr:hover {
      background-color: #cccccc;
      color: #000000;
      }
      
      .action_text_link {
      background-color: #aaeeff;
      color: #000000;
      }
      .action_text_link:hover {
      cursor: pointer;
      }

      .clickable_tbl_entry {
      background-color: #ffffff;
      color: #000000;
      }
      .clickable_tbl_entry:hover {
      background-color: #cccccc;
      color: #000000;
      cursor: pointer;
      }
    </style>
  </head>

  <body onload="main()" onresize="update_ui_components()">
    <!-- Start: Definition SVG for icons -->
    <svg style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs>
        <symbol id="via_logo">
          <title>VGG Image Annotator Logo</title>
	  <rect width="38" height="22" x="20" y="-50" transform="matrix(0,1,-1,0,0,0)" />
	  <rect width="38" height="22" x="12" y="-36" transform="matrix(0,1,-1,0,0,0)" />
	  <rect width="38" height="22" x="6" y="-45" transform="matrix(0,1,-1,0,0,0)" />
        </symbol>
	<symbol id="shape_rectangle">
	  <title>Rectangular region shape</title>
	  <rect width="20" height="12" x="6" y="10" />
	</symbol>
	<symbol id="shape_circle">
	  <title>Circular region shape</title>
	  <circle r="10" cx="16" cy="16" />
	</symbol>
	<symbol id="shape_ellipse">
	  <title>Elliptical region shape</title>
	  <ellipse rx="12" ry="8" cx="16" cy="16" />
	</symbol>
	<symbol id="shape_polygon">
	  <title>Polyline region shape</title>
	  <path d="M 15.25,2.2372 3.625,11.6122 6,29.9872 l 20.75,-9.625 2.375,-14.75 z" />
	</symbol>

      </defs>
    </svg>
    <!-- End: Define SVG for icons -->

    <div class="wrapper">
      <div id="navbar">
	<ul>
	  <li><svg style="stroke: #cccccc; fill: #000000;" height="40" viewBox="0 0 64 64"><use xlink:href="#via_logo"></use></svg></li>
          <li><a onclick="show_home_panel()" title="Home">Home</a></li>
          <li class="dropdown"><a title="Image" class="drop_menu_item">Image &#9662</a>
	    <div class="dropdown-content">
	      <a onclick="load_images()" title="Load a set of images from local disk">Load Images</a>
	      <a onclick="add_images()" title="Add new images to the current set of images being annotated">Add Images</a>
	    </div>
	  </li>
          <li class="dropdown"><a title="Annotations" class="drop_menu_item">Annotation &#9662</a>
	    <div class="dropdown-content">
	      <a onclick="download_all_region_data('csv')" title="Save image region annotations as a CSV(comma separated value) file">Save as CSV</a>
	      <a onclick="download_all_region_data('json')" title="Save image region annotations as a JSON(Javascript Object Notation) file">Save as JSON</a>
	      <a onclick="upload_region_data_file()" title="Import existing region data from CSV or JSON file">Import</a>
	    </div>
	  </li>
          <li class="dropdown"><a title="Attributes" class="drop_menu_item">Attributes &#9662</a>
	    <div class="dropdown-content">
	      <a onclick="save_attributes()" title="Save image region attributes to a local file">Save attributes</a>
	      <a onclick="import_attributes()" title="Import existing attributes from a file">Import attributes</a>
	      <a onclick="delete_all_attributes()" title="Delete all attributes">Delete attributes</a>
	    </div>
	  </li>
	  <li><a onclick="show_settings_panel()" title="Change settings of VGG Image Annotator">Settings</a></li>
	  <li class="dropdown"><a onclick="show_about_panel()" title="Help">Help &#9662</a>
	    <div class="dropdown-content">
	      <a href="https://gitlab.com/vgg/via/issues/new" target="_new" title="Report issues about this application">Report issue</a>
	      <a onclick="show_about_panel()" title="Import existing attributes from a file">About via</a>
	    </div>
	  </li>
	</ul>

	<input type="file" id="invisible_file_input" multiple name="files[]" style="display:none">
      </div> <!-- end of navbar -->

      <div class="main">
	<div class="box sidebar" id="info_panel">
	  <div class="title">Select Region Shape</div>
	  <div>
	    <div class="region_shape region_shape_selected" onclick="select_region_shape('rect')" id="region_shape_rect" title="To draw rectangular region"><svg height="32" viewbox="0 0 32 32"><use xlink:href="#shape_rectangle"></use></svg></div>
	    <div class="region_shape" onclick="select_region_shape('circle')" id="region_shape_circle" title="To draw circular region"><svg height="32" viewbox="0 0 32 32"><use xlink:href="#shape_circle"></use></svg></div>
	    <div class="region_shape" onclick="select_region_shape('ellipse')" id="region_shape_ellipse" title="To draw elliptical region"><svg height="32" viewbox="0 0 32 32"><use xlink:href="#shape_ellipse"></use></svg></div>
	    <div class="region_shape" onclick="select_region_shape('polygon')" id="region_shape_polygon" title="To draw polygon region"><svg height="32" viewbox="0 0 32 32"><use xlink:href="#shape_polygon"></use></svg></div>
	  </div>
	  

	  <div class="title">Image Information</div>
	  <div class="info">
	    <table id="image_info_table">
	      <tr>
		<td style="width: 7em;">File Id</td>
		<td id="info_current_fileid"></td>
	      </tr>
	      <tr>
		<td>File</td>
		<td id="info_current_filename"><span class="action_text_link" onclick="load_images()" title="Import existing attributes from a file">[click to load images]</span></td>
	      </tr>
	      <tr>
		<td>Regions</td>
		<td id="info_region"></td>
	      </tr>
	      <tr>
		<td>Attributes</td>
		<td id="info_attribute"></td>
	      </tr>	
	    </table>
	  </div>
	  
	  <div class="title">Region Attributes</div>
	  <table id="region_info_table"></table>
	  
	  <div class="title">Keyboard Shortcuts</div>
	  <div class="info">
	    <table>
	      <tr>
		<td style="width: 5.6em;">Alt + d</td>
		<td>Delete image region</td>
	      </tr>
	      <tr>
		<td>n/p</td>
		<td>Next/Previous image</td>
	      </tr>
	      <tr>
		<td>Ctrl + l</td>
		<td>Load or add images</td>
	      </tr>
	      <tr>
		<td>Ctrl + s</td>
		<td>Download region data</td>
	      </tr>
	      <tr>
		<td>Ctrl + i</td>
		<td>Import region data</td>
	      </tr>
	      <tr>
		<td>Esc</td>
		<td>Cancel current operation</td>
	      </tr>
	    </table>
	  </div>
	</div>
	
	<div class="box" id="image_panel">
	  <canvas id="image_canvas">Sorry, your browser does not support HTML5 Canvas functionality which is required for this application.</canvas>

	  <div id="via_start_info_panel">
	    <p>To begin the image annotation process, click <a title="Load images" style="cursor: pointer;" onclick="load_images()">Load images</a> in the Image menu.
	  </div>
	  
	  <div id="session_data_panel">
            <span style="color: red">Annotations from previous session exists</span>
	    <div id="image_annotation_list_snippet"></div>
	    <button onclick="save_image_annotation_data('csv')">Download CSV</button>
	    <button onclick="save_image_annotation_data('json')">Download JSON</button>
	    <button onclick="discard_via_session_data()">Discard Annotations</button>
          </div>

	  <div class="" id="about_panel" style="">
	    <!--<div><svg height="100" viewBox="0 0 64 64" style="stroke: #cccccc; fill: #ffffff; display:inline;"><use xlink:href="#via_logo"></use></svg></div>-->
	    <ul>
	      <li>VGG Image Annotator (via) is an open source project developed at the <a href="http://www.robots.ox.ac.uk/~vgg/">Visual Geometry Group</a> and released under the BSD-2 clause license.</li>
	      <li>This work was supported by EPSRC programme grant <a href="http://www.seebibyte.org/index.html">Seebibyte: Visual Search for the Era of Big Data</a> (<a href="http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/M013774/1">EP/M013774/1</a>).</li>
	      <li>This image annotation tool uses HTML, CSS and Javascript (<b>no dependencies on any javascript libraries</b>) and to run requires nothing more than a modern web browser</li>
	      <li>You are welcome to <a href="https://gitlab.com/vgg/via/issues/new">submit</a> bug reports and feature requests</li>
	      <li>For further information, please contact <a href="mailto:adutta-REMOVE-ME@robots.ox.ac.uk">Abhishek Dutta</a>.</li>
	    </ul>
          </div>
	  
	</div>
      </div> <!-- end of main -->
    </div> <!-- end of wrapper -->
    <div id="message_panel"></div>

    <script type="text/javascript" src="via.js">
      <!--AUTO_INSERT_VIA_JS_HERE-->
    </script>   
  </body>
</html>
